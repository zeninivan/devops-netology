# Домашнее задание к занятию "7.1. Инфраструктура как код"

## Задача 1
Выбор инструментов.

Вам, как девопс инженеру, будет необходимо принять решение об инструментах для организации инфраструктуры. 

Для этого в рамках совещания надо будет выяснить подробности о проекте, что бы в итоге определиться с инструментами:

    Какой тип инфраструктуры будем использовать для этого проекта: изменяемый или не изменяемый?
    Будет ли центральный сервер для управления инфраструктурой?
    Будут ли агенты на серверах?
    Будут ли использованы средства для управления конфигурацией или инициализации ресурсов?

В результате задачи необходимо

    Ответить на четыре вопроса представленных в разделе "Легенда".
    Какие инструменты из уже используемых вы хотели бы использовать для нового проекта?
    Хотите ли рассмотреть возможность внедрения новых инструментов для этого проекта?

### Ответ:
    Какой тип инфраструктуры будем использовать для этого проекта: изменяемый или не изменяемый?
Для данного проека я бы выбрал неизменяемый тип конфигурации, т.к. в организации уже год активно изспользуется Terraform + сделаны некоторые образы при помощи Packer.

    Будет ли центральный сервер для управления инфраструктурой?
Центральный сервер использовать не будем, т.к. для управления инфраструктурой у нас уже есть всё необходимое: Terraform, Docker, Kubernetes.

    Будут ли агенты на серверах?
Использование агентов не потребуется. Для работы с серверами будем использовать Terraform.

    Будут ли использованы средства для управления конфигурацией или инициализации ресурсов?
С учетом будущего роста количества новых клиентов и необходимостью частых доработок, откатов, тестирований я бы выбрал схему: инициализация ресурсов (Terraform) + шаблонизация (Packer, Docker) + оркестрация (Kubernetes). 
Без управления конфигурацией.

    Какие инструменты из уже используемых вы хотели бы использовать для нового проекта?
Для нового проекта я бы точно использовал: Terraform + Packer + Docker + Kubernetes. Остальные инструменты могут пригодиться в качестве вспомогательных.

    Хотите ли рассмотреть возможность внедрения новых инструментов для этого проекта?
На данном этапе (первое время, скорее всего, будет один внешний клиент) я думаю достаточно использовать уже существующие инструменты.

---

## Задача 2
Установка терраформ.

Официальный сайт: https://www.terraform.io/

Установите терраформ при помощи менеджера пакетов используемого в вашей операционной системе. В виде результата этой задачи приложите вывод команды terraform --version.

### Ответ:

Terraform уже был установлен ранее, в ходе прошлых занятий.

Проверяем версию установленного Terraform:

````
ivan@HP-Pavilion-dv6:~/devops-netology$ terraform --version
Terraform v1.2.6
on linux_amd64
ivan@HP-Pavilion-dv6:~/devops-netology$ 
````

---

## Задача 3 
Поддержка легаси кода.

В какой-то момент вы обновили терраформ до новой версии, например с 0.12 до 0.13. А код одного из проектов настолько устарел, что не может работать с версией 0.13. 
В связи с этим необходимо сделать так, чтобы вы могли одновременно использовать последнюю версию терраформа установленную при помощи штатного менеджера пакетов и устаревшую версию 0.12.
В виде результата этой задачи приложите вывод --version двух версий терраформа доступных на вашем компьютере или виртуальной машине.

### Ответ:

Версия terraform v1.2.6  у меня уже был установлена ранее из пакетного менеджера.

Для установки еще одной версии (v0.12.20) выполнил следующие шаги:

1. Создаем новый каталог:
mkdir -p /usr/local/tf/12

2. Скачиваем и распаковываем бинарник нужной версии в этот каталог:
````
oot@HP-Pavilion-dv6:/usr/local/tf/12# wget https://releases.hashicorp.com/terraform/0.12.20/terraform_0.12.20_linux_amd64.zip
--2022-08-03 17:59:12--  https://releases.hashicorp.com/terraform/0.12.20/terraform_0.12.20_linux_amd64.zip
Распознаётся releases.hashicorp.com (releases.hashicorp.com)… 151.101.38.49
Подключение к releases.hashicorp.com (releases.hashicorp.com)|151.101.38.49|:443... соединение установлено.
HTTP-запрос отправлен. Ожидание ответа… 200 OK
Длина: 16207833 (15M) [application/zip]
Сохранение в: «terraform_0.12.20_linux_amd64.zip»

terraform_0.12.20_linux_amd64.zip                    100%[=====================================================================================================================>]  15,46M   403KB/s    за 41s     

2022-08-03 17:59:54 (385 KB/s) - «terraform_0.12.20_linux_amd64.zip» сохранён [16207833/16207833]

root@HP-Pavilion-dv6:/usr/local/tf/12# unzip terraform_0.12.20_linux_amd64.zip
Archive:  terraform_0.12.20_linux_amd64.zip
  inflating: terraform               
root@HP-Pavilion-dv6:/usr/local/tf/12#
````

3. Создаём симлинк для новой версии Terraform в /usr/bin/ каталоге:
````
root@HP-Pavilion-dv6:/usr/local/tf/12# ln -s /usr/local/tf/12/terraform /usr/bin/terraform12
````

4. Делаем новый симлинк исполняемым:
````
root@HP-Pavilion-dv6:/usr/local/tf/12# chmod ugo+x /usr/bin/terraform*
````

Проверяем доступные версии:
````
ivan@HP-Pavilion-dv6:/usr/local$ terraform --version
Terraform v1.2.6
on linux_amd64
ivan@HP-Pavilion-dv6:/usr/local$ terraform12 --version
Terraform v0.12.20

Your version of Terraform is out of date! The latest version
is 1.2.6. You can update by downloading from https://www.terraform.io/downloads.html
````

---
